{"componentChunkName":"component---src-templates-blog-post-js","path":"/consuming-api-in-svelte/","result":{"data":{"site":{"siteMetadata":{"title":"Blaze codes"}},"markdownRemark":{"id":"60d75b1a-bdd9-5dc2-b539-444795fe486f","excerpt":"I’d been figuring out Svelte since a week now and saying that I’ve fallen in love with it would be an understatement. Everything is so much faster to do and…","html":"<p>I’d been figuring out Svelte since a week now and saying that I’ve fallen in love with it would be an understatement. Everything is so much faster to do and easier to understand that you’ll probably see me becoming an unofficial evangelist for it. To be honest, React was difficult for me to grasp and it took me atleast a month of trying it out on and off before I was comfortable with it. It was only after the introduction of hooks that I was able to use it better. With Svelte though, here I am writing an article about it after fiddling with it for just over a week!</p>\n<p>Without further ado, here we go!</p>\n<h1>Installation</h1>\n<p>Assuming you have Node installed on your system, enter the following in your command line, </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npx degit sveltejs/template numberfacts</code></pre></div>\n<p>This uses the template from the official Svelte repository on Github and provides us with a ready to use Hello World project. Once that is done, <code class=\"language-text\">cd</code> into your directory and run <code class=\"language-text\">npm install</code>. It should install all the packages that Svelte needs to run your project. If you followed it right, <code class=\"language-text\">npm run dev</code> should serve your project up on localhost:5000.</p>\n<p><img src=\"https://thepracticaldev.s3.amazonaws.com/i/jqw1hzw6tm6kms5v7e31.png\" alt=\"Svelte Hello World\"></p>\n<h1>What we’re making</h1>\n<p>We’ll be using the <a href=\"http://numberapi.com\">Numbers API</a> as our endpoint to generate random facts about any number our user enters.</p>\n<h1>Overview</h1>\n<p>This is what our directory structure looks like - </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">node_modules\npublic\nsrc\n--app.svelte\n--main.js\npackage.json\npackage-lock.json\nREADME.md\nrollup.config.js</code></pre></div>\n<p>I ignored the contents of the folders and have only focused on the ones we will be working with. In the <code class=\"language-text\">main.js</code> file, remove the <code class=\"language-text\">props: &#39;World&#39;</code> part and replace the contents of the <code class=\"language-text\">App.svelte</code> file with the following code,</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;script&gt;\n\tlet query = &quot;&quot;;\n\tlet result;\n\n\tasync function getResult() {\n\n\t\tlet response = await fetch(`http://numbersapi.com/${query}`);\n\t\tlet text = await response.text();\n\t\tlet data = text;\n\t\treturn data;\n\t}\n\n\tfunction submitHandler(e) {\n\t\tresult = getResult();\n\t}\n&lt;/script&gt;\n\n&lt;div class=&quot;container mt-5&quot;&gt;\n\t&lt;div class=&quot;row&quot;&gt;\n\t\t&lt;div class=&quot;col-md&quot;&gt;&lt;/div&gt;\n\t\t&lt;div class=&quot;col-md-8 text-center&quot;&gt;\n\t\t\t&lt;h1 class=&quot;display-4&quot;&gt;Random Number Facts&lt;/h1&gt;\n\t\t\t&lt;form class=&quot;form-inline&quot; on:submit|preventDefault={submitHandler}&gt;\n\t\t\t\t&lt;input class=&quot;w-75 form-control&quot; type=&quot;number&quot; bind:value={query}&gt;\n\t\t\t\t&lt;button class=&quot;w-25 btn btn-dark&quot;&gt;Submit&lt;/button&gt;\n\t\t\t&lt;/form&gt;\n\n\t\t\t{#if result===undefined}\n\n\t\t\t&lt;p&gt;&lt;/p&gt;\n\n\t\t\t{:else}\n\n\t\t\t{#await result}\n\n\t\t\t&lt;p&gt;Loading...&lt;/p&gt;\n\n\t\t\t{:then value}\n\n\t\t\t{value}\n\n\t\t\t{:catch error}\n\n\t\t\t{error.message}\n\t\t\t\t\n\t\t\t{/await}\n\n\t\t\t{/if}\n\t\t&lt;/div&gt;\n\t\t&lt;div class=&quot;col-md&quot;&gt;&lt;/div&gt;\n\t&lt;/div&gt;\n&lt;/div&gt;</code></pre></div>\n<h2>What is happening here?</h2>\n<p>In Svelte, an application is composed from one or more components. A component is a reusable self-contained block of code that encapsulates HTML, CSS and JavaScript that belong together, written into a <code class=\"language-text\">.svelte</code> file. The ‘hello world’ example we currently have is a simple component.</p>\n<p>In the code above, we are only using HTML and Javascript and letting Bootstrap take care of the CSS for us.</p>\n<p>We initialize a <code class=\"language-text\">query</code> string which we bind to the value of input using <code class=\"language-text\">bind:value={query}</code>. The curly brackets indicate that we are using JS variables inside HTML. Next, we declare a <code class=\"language-text\">result</code> variable that will store the result of our request when we send it.</p>\n<p>The <code class=\"language-text\">onSubmitHandler()</code> runs when the user enters a number in the input. We assign the return value of <code class=\"language-text\">getResult()</code> to <code class=\"language-text\">result</code> here. <code class=\"language-text\">getResult()</code> performs an async fetch request and returns the response.</p>\n<p>On to the HTML part, Svelte provides a lot of functionality out of the box which is very helpful. The <code class=\"language-text\">on:submit</code> directive is the Svelte version of the event listener in Javascript. We assign it the <code class=\"language-text\">onSubmitHandler()</code> function when the user presses ‘Submit’.</p>\n<p>The <code class=\"language-text\">{#await}</code>,<code class=\"language-text\">{:then}</code> and <code class=\"language-text\">{:catch}</code> blocks are used to resolve promises on the rendered component. The <code class=\"language-text\">{#if}</code> <code class=\"language-text\">{:else}</code> block as you may have guessed is a conditional block.</p>\n<h2>Creating a Card component</h2>\n<p>Next, we will create a new component that will render the content we get from the fetch request. Create a new file in the same directory and call it <code class=\"language-text\">Card.svelte</code>. Add the following code in <code class=\"language-text\">Card.svelte</code>,</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;script&gt;\nexport let data;\n&lt;/script&gt;\n    \n&lt;div class=&quot;card mt-5&quot;&gt;\n    &lt;div class=&quot;card-body&quot;&gt;\n        &lt;h5 class=&quot;card-title&quot;&gt;{data}&lt;/h5&gt;\n    &lt;/div&gt;\n&lt;/div&gt;</code></pre></div>\n<p>This one is pretty small. Here we simply write how we want our card to look like and where we want the rendered data to be. We use <code class=\"language-text\">export let data</code> to let our main <code class=\"language-text\">App.svelte</code> component use this variable to pass props down to our card. The syntax is a little weird in places, but you will get used to it. Just remember that Svelte is not Javascript. It’s a compiler for Javascript which builds to vanilla Javascript in production.</p>\n<p>Now, we have to make some changes in our <code class=\"language-text\">App.svelte</code> component to render our card. First, add this line in the script tag on top,</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">import Card from &#39;./Card.svelte&#39;;</code></pre></div>\n<p>Now we can add the card component as an HTML tag and pass down the result of our request to it as a prop, like so,</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">{#if result===undefined}\n\n &lt;p&gt;&lt;/p&gt;\n\n{:else}\n\n&lt;p&gt;Loading...&lt;/p&gt;\n\n{#await result}\n\n{:then value}\n\n &lt;Card data={value} /&gt;\n\n{:catch error}\n\n &lt;Card data={error.message}/&gt;\n\t\t\t\t\n{/await}\n\n{/if}</code></pre></div>\n<p>Aand, that’s pretty much it! You should be able to enter a number and have a result rendered on your screen. There are other minor things you can do, such as clearing the input field once a number is entered and adding a spinner instead of the loading p tag that we have right now. Svelte provides some <a href=\"https://svelte.dev/docs#svelte_transition\">animations and transitions</a> out of the box too!</p>\n<p>TL;DR Take me to the code:\n<a href=\"https://github.com/Blazephoenix/numberfacts\">Blazephoenix/numberfacts</a></p>","frontmatter":{"title":"Consuming an API in Svelte","date":"December 20, 2019","description":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/consuming-api-in-svelte/","previous":{"fields":{"slug":"/why-learning-program-like-owning-dog/"},"frontmatter":{"title":"Why learning to program is like owning a dog (in some ways)"}},"next":null}}}